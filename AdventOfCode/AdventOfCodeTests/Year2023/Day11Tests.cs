using AdventOfCode.Util;
using AdventOfCode.Year2023;

namespace AdventOfCodeTests.Year2023
{
    public class Day11Tests
    {
        [Test]
        public void CosmicTelescope_CanReadInput()
        {
            var cosmicTelescope = new CosmicTelescope(exampleInput1);

            cosmicTelescope.Universe.Width.Should().Be(10);
            cosmicTelescope.Universe.Height.Should().Be(10);
            cosmicTelescope.Universe[new Spot(3, 0)].Should().Be('#');
            cosmicTelescope.Universe[new Spot(0, 9)].Should().Be('#');
            cosmicTelescope.Universe[new Spot(7, 8)].Should().Be('#');
        }

        [Test]
        public void CosmicTelescope_CanExpandUniverse()
        {
            var cosmicTelescope = new CosmicTelescope(exampleInput1);

            cosmicTelescope.ExpandUniverse();

            cosmicTelescope.Galaxies[0].Should().Be(new LongSpot(4, 0));
            cosmicTelescope.Galaxies[6].Should().Be(new LongSpot(9, 10));
            cosmicTelescope.Galaxies[7].Should().Be(new LongSpot(0, 11));
        }

        [Test]
        public void CosmicTelescope_CanSolveExample1()
        {
            var cosmicTelescope = new CosmicTelescope(exampleInput1);
            cosmicTelescope.ExpandUniverse();

            cosmicTelescope.SumGalaxyPairDistance().Should().Be(374);
        }

        [Test]
        public void CosmicTelescope_CanSolvePart1()
        {
            var cosmicTelescope = new CosmicTelescope(input);
            cosmicTelescope.ExpandUniverse();

            cosmicTelescope.SumGalaxyPairDistance().Should().Be(9686930);
        }

        [Test]
        public void CosmicTelescope_CanSolveExample1Part2()
        {
            var cosmicTelescope = new CosmicTelescope(exampleInput1);
            cosmicTelescope.ExpandUniverse(10);

            cosmicTelescope.SumGalaxyPairDistance().Should().Be(1030);
        }

        [Test]
        public void CosmicTelescope_CanSolveExample2Part2()
        {
            var cosmicTelescope = new CosmicTelescope(exampleInput1);
            cosmicTelescope.ExpandUniverse(100);

            cosmicTelescope.SumGalaxyPairDistance().Should().Be(8410);
        }

        [Test]
        public void CosmicTelescope_CanSolvePart2()
        {
            var cosmicTelescope = new CosmicTelescope(input);
            cosmicTelescope.ExpandUniverse(1000000);

            cosmicTelescope.SumGalaxyPairDistance().Should().Be(630728425490);
        }

        const string exampleInput1 = "...#......\r\n.......#..\r\n#.........\r\n..........\r\n......#...\r\n.#........\r\n.........#\r\n..........\r\n.......#..\r\n#...#.....";
        const string input = ".#...........#.........................................................................#...............#...........#........................\r\n.......................#....................................................................................................................\r\n...............................#...........#.................#.............................#.............................................#..\r\n......#............................................#........................................................................................\r\n......................................................................#.....#.....................#.........................................\r\n.................#.......#.......................................#................#.....#.....................#.............................\r\n.........................................#.................#................................................................................\r\n................................#.............................................................#..........#..................................\r\n#.......................................................................#..............................................#.................#..\r\n..........#....................................#......................................#............................................#........\r\n................#....................................#........#.............................................................................\r\n......#........................................................................#............................................................\r\n......................#..............#..............................................................#..........#.....#......................\r\n..................................................#.......................#..................................................#..........#...\r\n............................#...............................................................................................................\r\n........#...................................................................................................................................\r\n..................#.......................#................................................................#................................\r\n.............................................................#........#.....................................................................\r\n..............................#.......#......................................#.............#........................#.......................\r\n.#............................................................................................................#...........................#.\r\n...................................................................................................#....................#...................\r\n....................#......................#.............#.....#..................................................................#.........\r\n.................................................................................................................#..........................\r\n............................................................................................................................................\r\n....................................................................#.....................#.................................................\r\n.................................#..............................................#..............#............#.............#.................\r\n...........................#............................................#...........................................#.......................\r\n......................#.........................#...........................................................................................\r\n.......................................#....................................#...................................#...........................\r\n.....#..........#.........................................#...............................................................................#.\r\n#..........#......................#...................................................#.......#.....#.......................................\r\n.........................#..................................................................................................................\r\n....................#..............................#.............#.........................................#.......#........#...............\r\n...........................................#........................................................................................#.......\r\n...........................................................#....................#...........................................................\r\n..........#....................................................................................................#............................\r\n...............#................................#..........................#..............................................................#.\r\n..#.................................#.................................................................#.......................#.............\r\n.....................#......#...............#........................#................................................#.....................\r\n..............................................................................................#....................................#........\r\n................................#.......#...................................................................................................\r\n..........#................................................#...................#.....#..............#..........#..........#.................\r\n.........................#..................................................................................................................\r\n..................#...............................#...........................................................................#.............\r\n.........................................................................#............................................#.....................\r\n........#.....#..............................................................................#.........#..................................#.\r\n.#...............................#......#............#.............................................................................#........\r\n....................................................................................#.............#...............#........#................\r\n...........................#................................................................................................................\r\n......................#..................................#..............#................................#.............#................#...\r\n...............................................................#..............#.............................................................\r\n..................................#........................................................#........#.......................................\r\n......#.................................#.......#....................#...............................................................#......\r\n.................#............#..............................................................................#.............................#\r\n............................................................................................................................................\r\n..#.....................#.............................................................................#.....................................\r\n.......................................................................................#..............................#.....................\r\n...............................................................................#.............#..............................................\r\n....................#.....................#...............................................................#.................................\r\n..........#........................#............#...................#.............................................#...............#.........\r\n............................#.............................#..........................#......................................................\r\n...........................................................................................#................................................\r\n.................................................................#.................................#.........................#........#.....\r\n.................#........................................................#..................................#..............................\r\n......................................#......................#..............................................................................\r\n.............#...........#...............................................................................#..........#.......................\r\n.................................#...........#...........................................................................#..............#...\r\n.......#............................................#.....#....................#..............#.....#.......................................\r\n...................#...........................................#................................................#...........................\r\n........................................................................................#...................................................\r\n...#....................#.....#............#.........................................................................................#......\r\n...............#.............................................................#..................#........#................#.................\r\n.........#.....................................#............................................................................................\r\n................................................................................................................................#...........\r\n.....................#.............#.........................................................................#..............................\r\n.....#...............................................................................................................#..............#......#\r\n...........#.......................................#.....#.................#.................#..............................................\r\n............................................................................................................................................\r\n.#.......................................#..........................................#................#......................................\r\n......................#.............#.................#.......................#...........#.............................#...................\r\n...............#.............#................................#......#.......................................................#..............\r\n............................................................................................................................................\r\n...#............................................................................................#....................#......................\r\n..........#.....................#.............................................................................#.............................\r\n...........................#...............................................................................................#...............#\r\n.....................#......................................#.......#......#........#..................#...........................#........\r\n.....#...............................#............#.........................................................................................\r\n............................................................................................................................................\r\n.........................................................#........................................................#.........................\r\n#..............................#..........#..............................................................................#................#.\r\n....................#..............................................#.......................#.........#......................................\r\n............................................................................................................................................\r\n...........#.......................................#.............................................................................#..........\r\n...#......................#...............................................#......................#..........................................\r\n..................#.........................................................................................................................\r\n...........................................................#........#...........#.....#......#........................#.................#...\r\n........#...................................................................................................................................\r\n....................................................................................................#......#................................\r\n................................#...........#....................#.....#...................................................#........#.......\r\n........................#............#......................................#.............#.................................................\r\n...................#............................................................................................#...........................\r\n#................................................................................................................................#..........\r\n..............#.............................................#...............................................................................\r\n..............................#...............................................#.................#......................................#....\r\n....#....................#......................................#...................#...............................#.......#...............\r\n........................................#..........#........................................#................#..............................\r\n............................................................................................................................................\r\n............................................................................................................................................\r\n........................................................................................................................................#...\r\n...........................................................#..................#.................#.................#.........................\r\n.......#........................................................#................................................................#..........\r\n..........................#......#......#..................................................................................#................\r\n...............................................#.....#.................#....................................................................\r\n......................................................................................................#.....................................\r\n................#....................#.....................................................................#........#.......................\r\n..............................................................................................................................#.............\r\n...........................................#.............................................................................................#..\r\n....#........................#..............................#.............#................#................................................\r\n......................#..........................................................................................#......#...................\r\n....................................................#................................#.........#............................................\r\n..........................#.......................................#.........................................................................\r\n.................#........................#.....#........................................................#..................................\r\n.#.........................................................#............#....................................................#..............\r\n..........#..................#.....#..................................................................................................#.....\r\n.................................................................................#..........................................................\r\n.....................................................#....................................#.........#...........#.....#.....................\r\n.............................................#.....................#.......................................#.......................#........\r\n................................#...........................................................................................................\r\n......#........................................................#..............................#.............................................\r\n............#......................................#.....#............................#........................................#............\r\n............................................................................#...............................................................\r\n.......................................#...............................#...................#..............................#...........#.....\r\n.......................#..............................#..........................#..............................#...........................\r\n.................................................................#...................................#......................................\r\n......................................................................................................................#...................#.\r\n.................#..........................................................................................................................\r\n.........#......................#.....#...........#.......................................................#.................................\r\n...........................................#.................#................#.....................................................#.......\r\n..#...............................................................#.........................................................................\r\n.....................#......#......#.............................................................#............#...........#.................";
    }
}
